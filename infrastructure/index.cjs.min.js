"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@vuelidate/core"),r=require("vue"),t=require("@vuelidate/validators"),s=require("lodash.throttle");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=a(e),l=a(s);function o(e,t,s){const a=t.value,u=r.ref(!1),l=r.ref({}),o=r.computed((()=>{const r=s.value[e].$errors;return u.value||0===r.length?{}:r.reduce(((e,r)=>({...e,[r.$validator]:"string"==typeof r.$message?r.$message:r.$message.value})),{...l.value})})),i=r.computed((()=>{const e=Object.keys(l.value);return 0===e.length?null:{[e[0]]:l.value[e[0]]}})),n=r.computed((()=>{const r=i.value,t=s.value[e].$errors[0];return u.value||!t&&!r?null:t?{[t.$validator]:"string"==typeof t.$message?t.$message:t.$message.value}:r})),v=r.computed((()=>!u.value&&!!n.value)),c=r.computed((()=>!v.value)),d=e=>{t.value=e};return{error:n,errors:o,value:t,setValue:d,invalid:v,valid:c,reset:()=>{d(a),s.value[e].$reset()},disabled:u,disable:()=>{u.value=!0},enable:()=>{u.value=!1},markAsTouch:()=>{u.value||s.value[e].$touch()},setErrors:e=>{l.value=e},removeErrors:e=>{l.value=Object.keys(l.value).reduce(((r,t)=>e.includes(t)?r:{...r,[t]:l.value[t]}),{})}}}const i=t.helpers.withMessage("Заполните поле",t.required),n=t.helpers.withMessage("Заполните поле",(e=>!0===e)),v=t.helpers.withMessage("Введите корректный адрес электронной почты",t.email),c=t.helpers.withMessage("Некорректный номер мобильного телефона",(e=>/^[+]*7\d{10}$/.test(e.replace(/[+ \-_]/g,""))));exports.createForm=function(e){const t=Object.keys(e).reduce(((r,t)=>{const[s,a]=e[t];return{...r,[t]:a||{}}}),{}),s=Object.keys(e).reduce(((t,s)=>{const[a]=e[s];return{...t,[s]:r.ref(a)}}),{}),a=u.default(t,s),l=Object.keys(s).reduce(((e,r)=>({...e,[r]:o(r,s[r],a)})),{}),i=r.computed((()=>Object.keys(l).some((e=>l[e].invalid.value)))),n=r.computed((()=>!i.value)),v=r.computed((()=>i.value?Object.keys(l).filter((e=>l[e].invalid.value)).reduce(((e,r)=>({...e,[r]:l[r].errors.value})),{}):{})),c=()=>{Object.keys(l).forEach((e=>l[e].markAsTouch()))};return{invalid:i,valid:n,markAsTouch:c,errors:v,validate:()=>{c()},value:s,getCurrentValue:()=>Object.keys(s).reduce(((e,r)=>({...e,[r]:s[r].value})),{}),...l}},exports.email=v,exports.maxLength=e=>t.helpers.withMessage(`Длина должна быть не больше ${e}`,t.maxLength(e)),exports.maxValue=e=>t.helpers.withMessage(`Значение должно быть не больше ${e}`,t.maxValue(e)),exports.minLength=e=>t.helpers.withMessage(`Длина должна быть не меньше ${e}`,t.minLength(e)),exports.minValue=e=>t.helpers.withMessage(`Значение должно быть не меньше ${e}`,t.minValue(e)),exports.not=e=>t.helpers.withMessage("Заполните поле",(r=>r!==e)),exports.pattern=e=>t.helpers.withMessage("Невалидное поле",(r=>("string"==typeof e?new RegExp(e):e).test(r))),exports.phone=c,exports.required=i,exports.requiredTrue=n,exports.throttle=function(e,r){return l.default(e,r,{leading:!0,trailing:!1})};
