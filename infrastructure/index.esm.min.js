import e from"@vuelidate/core";import{ref as a,computed as s}from"vue";import{helpers as r,required as t,email as u,minValue as l,maxValue as i,minLength as v,maxLength as o}from"@vuelidate/validators";import n from"lodash.throttle";function c(e,r,t){const u=r.value,l=a(!1),i=a({}),v=s((()=>{const a=t.value[e].$errors;return l.value||0===a.length?{}:a.reduce(((e,a)=>({...e,[a.$validator]:"string"==typeof a.$message?a.$message:a.$message.value})),{...i.value})})),o=s((()=>{const e=Object.keys(i.value);return 0===e.length?null:{[e[0]]:i.value[e[0]]}})),n=s((()=>{const a=o.value,s=t.value[e].$errors[0];return l.value||!s&&!a?null:s?{[s.$validator]:"string"==typeof s.$message?s.$message:s.$message.value}:a})),c=s((()=>!l.value&&!!n.value)),g=s((()=>!c.value)),d=e=>{r.value=e};return{error:n,errors:v,value:r,setValue:d,invalid:c,valid:g,reset:()=>{d(u),t.value[e].$reset()},disabled:l,disable:()=>{l.value=!0},enable:()=>{l.value=!1},markAsTouch:()=>{l.value||t.value[e].$touch()},setErrors:e=>{i.value=e},removeErrors:e=>{i.value=Object.keys(i.value).reduce(((a,s)=>e.includes(s)?a:{...a,[s]:i.value[s]}),{})}}}function g(r){const t=Object.keys(r).reduce(((e,a)=>{const[s,t]=r[a];return{...e,[a]:t||{}}}),{}),u=Object.keys(r).reduce(((e,s)=>{const[t]=r[s];return{...e,[s]:a(t)}}),{}),l=e(t,u),i=Object.keys(u).reduce(((e,a)=>({...e,[a]:c(a,u[a],l)})),{}),v=s((()=>Object.keys(i).some((e=>i[e].invalid.value)))),o=s((()=>!v.value)),n=s((()=>v.value?Object.keys(i).filter((e=>i[e].invalid.value)).reduce(((e,a)=>({...e,[a]:i[a].errors.value})),{}):{})),g=()=>{Object.keys(i).forEach((e=>i[e].markAsTouch()))};return{invalid:v,valid:o,markAsTouch:g,errors:n,validate:()=>{g()},value:u,getCurrentValue:()=>Object.keys(u).reduce(((e,a)=>({...e,[a]:u[a].value})),{}),...i}}const d=r.withMessage("Заполните поле",t),m=r.withMessage("Заполните поле",(e=>!0===e)),h=r.withMessage("Введите корректный адрес электронной почты",u),$=e=>r.withMessage(`Значение должно быть не меньше ${e}`,l(e)),b=e=>r.withMessage(`Значение должно быть не больше ${e}`,i(e)),f=e=>r.withMessage(`Длина должна быть не меньше ${e}`,v(e)),k=e=>r.withMessage(`Длина должна быть не больше ${e}`,o(e)),y=r.withMessage("Некорректный номер мобильного телефона",(e=>/^[+]*7\d{10}$/.test(e.replace(/[+ \-_]/g,"")))),w=e=>r.withMessage("Заполните поле",(a=>a!==e)),p=e=>r.withMessage("Невалидное поле",(a=>("string"==typeof e?new RegExp(e):e).test(a)));function M(e,a){return n(e,a,{leading:!0,trailing:!1})}export{g as createForm,h as email,k as maxLength,b as maxValue,f as minLength,$ as minValue,w as not,p as pattern,y as phone,d as required,m as requiredTrue,M as throttle};
