"use strict";var e=require("vue");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(require("@smartmed/webpatient-vue-components/ActiveZone"));var o=e.defineComponent({components:{ActiveZone:n.default},name:"DropdownHost",props:{modelValue:{type:Boolean,required:!0},canOpen:{type:Boolean,default:!0},minHeight:{type:Number},maxHeight:{type:Number,default:400},maxWidth:{type:Number},minWidth:{type:Number},align:{type:String,default:"right",validatior:e=>["left","right"].includes(e)},direction:{type:String,default:"bottom",validator:e=>["top","bottom"].includes(e)}},setup(t,{emit:n}){const{modelValue:o,canOpen:l,maxHeight:d,maxWidth:a,minHeight:r,direction:i,minWidth:u}=e.toRefs(t),p=e.ref(null),s=e.ref(null),c=e.ref(null),m=e.ref(null),v=e.ref(null);e.watch(l,((e,t)=>{t&&!e&&n("update:modelValue",!1)}));const h=e.computed((()=>{const e=a.value,t=u.value,n=p.value;return{"max-width":e?`${e}px`:null,"min-width":t?`${t}px`:null,"max-height":n?`${n}px`:null,top:s.value,bottom:c.value}})),_=()=>{o.value&&n("update:modelValue",!1)},w=e.ref(!1),f=()=>{if(!m.value||!v.value)return;const e=window.innerHeight,t=m.value.activeZone.getBoundingClientRect(),n=Math.min(d.value,e-8),o=t.top-8,l=e-t.bottom-8,a=(e=>{const t=window.innerHeight,n=e.top-8,o=t-e.bottom-8,l=Math.min(d.value,t-8),a=Math.min(Math.max(v.value.getBoundingClientRect().height,r.value||80),l);let u=null;switch(i.value){case"top":n>=(r.value||a)&&(u="top");break;case"bottom":o>=(r.value||a)&&(u="bottom")}return null===u&&(u=w.value&&n>=a?"top":o>=a||o>=n?"bottom":"top"),u})(t);w.value="top"===a,"top"===a?(p.value=Math.min(n,o),s.value="auto",c.value="100%"):(p.value=Math.min(n,l),s.value="100%",c.value="auto")};return e.onMounted((()=>{o.value&&l.value&&f()})),e.onUpdated((()=>{o.value&&l.value&&f()})),e.watch(o,(e=>{l.value&&(e?(window.addEventListener("scroll",f),window.addEventListener("resize",f)):(window.removeEventListener("scroll",f),window.removeEventListener("resize",f)))})),e.onBeforeUnmount((()=>{window.removeEventListener("scroll",f),window.removeEventListener("resize",f)})),{hide:_,toggleOpen:()=>{l.value&&n("update:modelValue",!o.value)},activeZoneChanged:e=>{e||_()},dropdownStyle:h,host:m,dropdown:v}}});!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css","top"===n&&o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}}("._container_1j17e_1 {\n  position: relative;\n  display: inline-flex;\n}\n._content_1j17e_6 {\n  border-radius: inherit;\n  height: inherit;\n  flex: 1 1 auto;\n  width: 100%;\n}\n._dropdown_1j17e_13 {\n  position: absolute;\n  overflow: hidden;\n  top: 100%;\n  width: 100%;\n  padding: 2px 0;\n  background-color: var(--smed-base-09);\n  border-radius: 8px;\n  box-sizing: border-box;\n  box-shadow: 0px 5px 16px -4px rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--smed-base-08);\n  z-index: 1;\n}\n._dropdown_right_1j17e_26 {\n  right: 0;\n}\n._dropdown_left_1j17e_29 {\n  left: 0;\n}\n._dropdown_top_1j17e_32 {\n  top: 0;\n  transform: translateY(-100%);\n}\n._dropdown_bottom_1j17e_36 {\n  top: 100%;\n}");(o.__cssModules={}).$style={container:"_container_1j17e_1",content:"_content_1j17e_6",dropdown:"_dropdown_1j17e_13",dropdown_right:"_dropdown_right_1j17e_26",dropdown_left:"_dropdown_left_1j17e_29",dropdown_top:"_dropdown_top_1j17e_32",dropdown_bottom:"_dropdown_bottom_1j17e_36"},o.render=function(t,n,o,l,d,a){const r=e.resolveComponent("active-zone");return e.openBlock(),e.createBlock(r,{ref:"host",class:e.normalizeClass(t.$style.container),onKeyup:e.withKeys(e.withModifiers(t.hide,["stop"]),["esc"]),onActiveZoneChanged:t.activeZoneChanged},{default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass(t.$style.content),onClick:n[0]||(n[0]=e.withModifiers(((...e)=>t.toggleOpen&&t.toggleOpen(...e)),["stop","prevent"]))},[e.renderSlot(t.$slots,"default")],2),t.canOpen?(e.openBlock(),e.createBlock(e.Transition,{key:0,name:"fade"},{default:e.withCtx((()=>[t.modelValue?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass([t.$style.dropdown,t.$style["dropdown_"+t.align]]),style:e.normalizeStyle(t.dropdownStyle),ref:"dropdown"},[e.renderSlot(t.$slots,"dropdown")],6)):e.createCommentVNode("",!0)])),_:3})):e.createCommentVNode("",!0)])),_:3},8,["class","onKeyup","onActiveZoneChanged"])},module.exports=o;
