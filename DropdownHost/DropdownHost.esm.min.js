import{defineComponent as e,toRefs as t,ref as n,watch as o,computed as d,onMounted as l,onUpdated as a,onBeforeUnmount as i,resolveComponent as r,openBlock as u,createBlock as p,normalizeClass as s,withKeys as m,withModifiers as v,withCtx as c,createElementVNode as _,renderSlot as h,Transition as w,createElementBlock as g,normalizeStyle as f,createCommentVNode as b}from"vue";import x from"@smartmed/webpatient-vue-components/ActiveZone";var y=e({components:{ActiveZone:x},name:"DropdownHost",props:{modelValue:{type:Boolean,required:!0},canOpen:{type:Boolean,default:!0},minHeight:{type:Number},maxHeight:{type:Number,default:400},maxWidth:{type:Number},minWidth:{type:Number},align:{type:String,default:"right",validatior:e=>["left","right"].includes(e)},direction:{type:String,default:"bottom",validator:e=>["top","bottom"].includes(e)}},setup(e,{emit:r}){const{modelValue:u,canOpen:p,maxHeight:s,maxWidth:m,minHeight:v,direction:c,minWidth:_}=t(e),h=n(null),w=n(null),g=n(null),f=n(null),b=n(null);o(p,((e,t)=>{t&&!e&&r("update:modelValue",!1)}));const x=d((()=>{const e=m.value,t=_.value,n=h.value;return{"max-width":e?`${e}px`:null,"min-width":t?`${t}px`:null,"max-height":n?`${n}px`:null,top:w.value,bottom:g.value}})),y=()=>{u.value&&r("update:modelValue",!1)},j=n(!1),C=()=>{if(!f.value||!b.value)return;const e=window.innerHeight,t=f.value.activeZone.getBoundingClientRect(),n=Math.min(s.value,e-8),o=t.top-8,d=e-t.bottom-8,l=(e=>{const t=window.innerHeight,n=e.top-8,o=t-e.bottom-8,d=Math.min(s.value,t-8),l=Math.min(Math.max(b.value.getBoundingClientRect().height,v.value||80),d);let a=null;switch(c.value){case"top":n>=(v.value||l)&&(a="top");break;case"bottom":o>=(v.value||l)&&(a="bottom")}return null===a&&(a=j.value&&n>=l?"top":o>=l||o>=n?"bottom":"top"),a})(t);j.value="top"===l,"top"===l?(h.value=Math.min(n,o),w.value="auto",g.value="100%"):(h.value=Math.min(n,d),w.value="100%",g.value="auto")};return l((()=>{u.value&&p.value&&C()})),a((()=>{u.value&&p.value&&C()})),o(u,(e=>{p.value&&(e?(window.addEventListener("scroll",C),window.addEventListener("resize",C)):(window.removeEventListener("scroll",C),window.removeEventListener("resize",C)))})),i((()=>{window.removeEventListener("scroll",C),window.removeEventListener("resize",C)})),{hide:y,toggleOpen:()=>{p.value&&r("update:modelValue",!u.value)},activeZoneChanged:e=>{e||y()},dropdownStyle:x,host:f,dropdown:b}}});!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style");d.type="text/css","top"===n&&o.firstChild?o.insertBefore(d,o.firstChild):o.appendChild(d),d.styleSheet?d.styleSheet.cssText=e:d.appendChild(document.createTextNode(e))}}("._container_1j17e_1 {\n  position: relative;\n  display: inline-flex;\n}\n._content_1j17e_6 {\n  border-radius: inherit;\n  height: inherit;\n  flex: 1 1 auto;\n  width: 100%;\n}\n._dropdown_1j17e_13 {\n  position: absolute;\n  overflow: hidden;\n  top: 100%;\n  width: 100%;\n  padding: 2px 0;\n  background-color: var(--smed-base-09);\n  border-radius: 8px;\n  box-sizing: border-box;\n  box-shadow: 0px 5px 16px -4px rgba(0, 0, 0, 0.2);\n  border: 1px solid var(--smed-base-08);\n  z-index: 1;\n}\n._dropdown_right_1j17e_26 {\n  right: 0;\n}\n._dropdown_left_1j17e_29 {\n  left: 0;\n}\n._dropdown_top_1j17e_32 {\n  top: 0;\n  transform: translateY(-100%);\n}\n._dropdown_bottom_1j17e_36 {\n  top: 100%;\n}");(y.__cssModules={}).$style={container:"_container_1j17e_1",content:"_content_1j17e_6",dropdown:"_dropdown_1j17e_13",dropdown_right:"_dropdown_right_1j17e_26",dropdown_left:"_dropdown_left_1j17e_29",dropdown_top:"_dropdown_top_1j17e_32",dropdown_bottom:"_dropdown_bottom_1j17e_36"},y.render=function(e,t,n,o,d,l){const a=r("active-zone");return u(),p(a,{ref:"host",class:s(e.$style.container),onKeyup:m(v(e.hide,["stop"]),["esc"]),onActiveZoneChanged:e.activeZoneChanged},{default:c((()=>[_("div",{class:s(e.$style.content),onClick:t[0]||(t[0]=v(((...t)=>e.toggleOpen&&e.toggleOpen(...t)),["stop","prevent"]))},[h(e.$slots,"default")],2),e.canOpen?(u(),p(w,{key:0,name:"fade"},{default:c((()=>[e.modelValue?(u(),g("div",{key:0,class:s([e.$style.dropdown,e.$style["dropdown_"+e.align]]),style:f(e.dropdownStyle),ref:"dropdown"},[h(e.$slots,"dropdown")],6)):b("",!0)])),_:3})):b("",!0)])),_:3},8,["class","onKeyup","onActiveZoneChanged"])};export{y as default};
