import{defineComponent as e,toRefs as t,ref as n,inject as o,provide as l,computed as a,watch as i,resolveComponent as r,openBlock as s,createBlock as u,normalizeClass as d,withKeys as m,withCtx as c,renderSlot as p,createVNode as v,mergeProps as h,createSlots as f,withModifiers as g,createCommentVNode as _}from"vue";import y from"@smartmed/webpatient-vue-components/BaseInput";import b from"@smartmed/webpatient-vue-components/DropdownHost";import w from"@smartmed/webpatient-vue-components/SvgIcon";import{CONTROL_ACCESSOR_TOKEN as x}from"@smartmed/webpatient-vue-components/tokens";var $=e({inheritAttrs:!1,components:{BaseInput:y,DropdownHost:b,SvgIcon:w},name:"Combobox",props:{modelValue:{type:[String,Number,Object,null],required:!0},items:{type:[Array,null],default:()=>[]},stringify:{type:Function,default:e=>e},disabled:Boolean,matcher:Function,itemsFilter:Function,minHeight:Number,maxHeight:Number,maxWidth:Number,align:String,direction:String},setup(e,{emit:r}){const{modelValue:s,items:u}=t(e),d=n(!1),m=n(null),c=o(x,null);c&&l(x,null);const p=(t,n)=>e.stringify(t)===e.stringify(n),v=a((()=>{if(!u.value)return null;const t=e.matcher||p;return u.value.find((e=>t(s.value,e)))})),h=a((()=>{if(null===u.value)return null;if(v.value)return u.value;const t=e.itemsFilter||p;return u.value.filter((e=>t(s.value,e)))})),f=a((()=>null!==s.value&&String(s.value).length>0));i(d,(e=>{!e&&c&&c.markAsTouch()})),i(s,(()=>{d.value||!f.value||v.value||g()})),i(v,(e=>{e&&(_(),m.value&&m.value.focus())}));const g=()=>{d.value=!0},_=()=>{d.value=!1};return{hide:_,opened:d,filteredItems:h,baseInput:m,onKeyupEnter:e=>{d.value&&e.preventDefault();const t=h.value;t&&1===t.length&&r("update:modelValue",t[0])}}}});!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css","top"===n&&o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}}("._host_1cv49_1 {\n  width: 100%;\n}\n._icon_1cv49_5 {\n  transition: transform 0.2s linear;\n  color: var(--smed-base-05);\n  cursor: pointer;\n}\n._icon_rotated_1cv49_10 {\n  transform: rotate(180deg);\n}");($.__cssModules={}).$style={host:"_host_1cv49_1",icon:"_icon_1cv49_5",icon_rotated:"_icon_rotated_1cv49_10"},$.render=function(e,t,n,o,l,a){const i=r("svg-icon"),y=r("base-input"),b=r("dropdown-host");return s(),u(b,{modelValue:e.opened,"onUpdate:modelValue":t[2]||(t[2]=t=>e.opened=t),class:d(e.$style.host),align:e.align,"can-open":!e.disabled,direction:e.direction,"max-height":e.maxHeight,"max-width":e.maxWidth,"min-height":e.minHeight,onKeyup:m(e.onKeyupEnter,["enter"])},{dropdown:c((()=>[p(e.$slots,"dropdown",{items:e.filteredItems})])),default:c((()=>[v(y,h(e.$attrs,{"has-cleaner":"",ref:"baseInput",disabled:e.disabled,"model-value":e.modelValue,stringify:e.stringify,onSearchClear:t[1]||(t[1]=t=>e.$emit("update:modelValue",null))}),f({right:c((()=>[v(i,{name:"arrow-down",class:d([e.$style.icon,e.opened&&e.$style.icon_rotated]),onClick:t[0]||(t[0]=g((()=>{}),["stop"]))},null,8,["class"])])),valueContent:c((()=>[e.$slots.valueContent?p(e.$slots,"valueContent",{key:0,value:e.modelValue}):_("",!0)])),_:2},[e.$slots.left?{name:"left",fn:c((()=>[p(e.$slots,"left")]))}:void 0]),1040,["disabled","model-value","stringify"])])),_:3},8,["modelValue","class","align","can-open","direction","max-height","max-width","min-height","onKeyup"])};export{$ as default};
