this.smartmed=this.smartmed||{},this.smartmed.VirtualList=function(e){"use strict";var t,a;!function(e){e.FRONT="FRONT",e.BEHIND="BEHIND"}(t||(t={})),function(e){e.INIT="INIT",e.FIXED="FIXED",e.DYNAMIC="DYNAMIC"}(a||(a={}));const i=(e,i)=>{const o={range:{},sizes:new Map,firstRangeTotalSize:0,firstRangeAverageSize:0,lastCalcIndex:0,fixedSizeValue:0,calcType:a.INIT,direction:null,param:e,callUpdate:i,offset:0,destroy(){this.range={},this.sizes=new Map,this.firstRangeTotalSize=0,this.firstRangeAverageSize=0,this.lastCalcIndex=0,this.fixedSizeValue=0,this.calcType=a.INIT,this.offset=0,this.direction=null},getRange(){const{start:e,end:t,padFront:a,padBehind:i}=this.range;return{start:e,end:t,padFront:a,padBehind:i}},isBehind(){return this.direction===t.BEHIND},isFront(){return this.direction===t.FRONT},getOffset(e){return(e<1?0:this.getIndexOffset(e))+this.param.slotHeaderSize},updateParam(e,t){this.param&&e in this.param&&("uniqueIds"===e&&this.sizes.forEach(((e,a)=>{!t.includes(a)&&this.sizes.delete(a)})),this.param[e]=t)},saveSize(e,t){this.sizes.set(e,t),this.calcType===a.INIT?(this.fixedSizeValue=t,this.calcType=a.FIXED):this.calcType===a.FIXED&&this.fixedSizeValue!==t&&(this.calcType=a.DYNAMIC,this.fixedSizeValue=null),this.calcType!==a.FIXED&&void 0!==this.firstRangeTotalSize&&(this.sizes.size<Math.min(this.param.keeps,this.param.uniqueIds.length)?(this.firstRangeTotalSize=[...this.sizes.values()].reduce(((e,t)=>e+t),0),this.firstRangeAverageSize=Math.round(this.firstRangeTotalSize/this.sizes.size)):this.firstRangeTotalSize=null)},handleItemsChange(){let e=this.range.start;this.isFront()?e-=5:this.isBehind()&&(e+=5),e=Math.max(e,0),this.updateRange(this.range.start,this.getEndByStart(e))},handleSlotSizeChange(){this.handleItemsChange()},handleScroll(e){this.direction=e<this.offset?t.FRONT:t.BEHIND,this.offset=e,this.param&&(this.direction===t.FRONT?this.handleFront():this.direction===t.BEHIND&&this.handleBehind())},handleFront(){const e=this.getScrollOvers();if(this.range.start&&e>this.range.start)return;const t=Math.max(e-this.param.buffer,0);this.checkRange(t,this.getEndByStart(t))},handleBehind(){const e=this.getScrollOvers();this.range.start&&e<this.range.start+this.param.buffer||this.checkRange(e,this.getEndByStart(e))},getScrollOvers(){const e=this.offset-this.param.slotHeaderSize;if(e<=0)return 0;if(this.isFixedType())return Math.floor(e/this.fixedSizeValue);let t=0,a=0,i=0,o=this.param.uniqueIds.length;for(;t<=o;){if(a=t+Math.floor((o-t)/2),i=this.getIndexOffset(a),i===e)return a;i<e?t=a+1:i>e&&(o=a-1)}return t>0?--t:0},getIndexOffset(e){if(!e)return 0;let t,a=0;for(let i=0;i<e;i++)t=this.sizes.get(this.param.uniqueIds[i]),a+="number"==typeof t?t:this.getEstimateSize();return this.lastCalcIndex=Math.max(this.lastCalcIndex,e-1),this.lastCalcIndex=Math.min(this.lastCalcIndex,this.getLastIndex()),a},isFixedType(){return this.calcType===a.FIXED},getLastIndex(){return this.param.uniqueIds.length-1},checkRange(e,t){const a=this.param.keeps;this.param.uniqueIds.length<=a?(e=0,t=this.getLastIndex()):t-e<a-1&&(e=t-a+1),this.range.start!==e&&this.updateRange(e,t)},updateRange(e,t){this.range.start=e,this.range.end=t,this.range.padFront=this.getPadFront(),this.range.padBehind=this.getPadBehind(),this.callUpdate(this.getRange())},getEndByStart(e){const t=e+this.param.keeps-1;return Math.min(t,this.getLastIndex())},getPadFront(){return this.isFixedType()?this.fixedSizeValue*this.range.start:this.getIndexOffset(this.range.start)},getPadBehind(){const e=this.range.end,t=this.getLastIndex();return this.isFixedType()?(t-e)*this.fixedSizeValue:this.lastCalcIndex===t?this.getIndexOffset(t)-this.getIndexOffset(e):(t-e)*this.getEstimateSize()},getEstimateSize(){return this.isFixedType()?this.fixedSizeValue:this.firstRangeAverageSize||this.param.estimateSize}};return e&&o.checkRange(0,e.keeps-1),o};var o=e.defineComponent({name:"VirtualListItem",props:{horizontal:{type:Boolean}},setup(t,a){const{horizontal:i}=e.toRefs(t),o=e.ref(null);let s=null;const n=e.computed((()=>i.value?"offsetWidth":"offsetHeight"));e.onMounted((()=>{"undefined"!=typeof ResizeObserver&&o.value&&(s=new ResizeObserver((()=>{r()})),s.observe(o.value))}));const r=()=>{a.emit("item-resize",l())},l=()=>o.value?o.value[n.value]:0;return e.onUpdated((()=>{r()})),e.onBeforeUnmount((()=>{s&&(s.disconnect(),s=null)})),{root:o}}});const s={ref:"root",role:"listitem"};var n;o.render=function(t,a,i,o,n,r){return e.openBlock(),e.createElementBlock("div",s,[e.renderSlot(t.$slots,"default")],512)},function(e){e.HORIZONTAL="horizontal",e.VERTICAL="vertical"}(n||(n={}));var r=e.defineComponent({components:{Item:o},name:"VirtualList",props:{items:{type:Array,required:!0},dataKey:{type:String,required:!0,default:"id"},keeps:{type:Number,default:50},estimateSize:{type:Number,default:50},pageMode:{type:Boolean},direction:{type:String,validator:e=>Object.values(n).includes(e),default:n.VERTICAL},start:{type:Number,default:0},offset:{type:Number,default:0},topThreshold:{type:Number,default:0},bottomThreshold:{type:Number,default:0}},setup(t,a){const{dataKey:o,items:s,direction:r,start:l,offset:d,topThreshold:u,bottomThreshold:h,keeps:c,pageMode:p}=e.toRefs(t),f=e.ref({}),m=e.ref(null),g=e.ref(null),v=e.computed((()=>s.value.map((e=>e[o.value])))),z=e.computed((()=>r.value===n.HORIZONTAL)),S=e.computed((()=>z.value?"scrollLeft":"scrollTop")),_=i({slotHeaderSize:0,slotFooterSize:0,keeps:t.keeps,estimateSize:t.estimateSize,buffer:Math.round(t.keeps/3),uniqueIds:v.value},(e=>{f.value=e}));e.onBeforeMount((()=>{k(_.offset)})),e.onMounted((()=>{l.value?x(l.value):d.value&&k(d.value),p.value&&(B(),document.addEventListener("scroll",E,{passive:!1}))}));const x=e=>{if(e>=s.value.length-1)I();else{const t=_.getOffset(e);k(t)}},I=()=>{if(g.value){const e=g.value[z.value?"offsetLeft":"offsetTop"];k(e),setTimeout((()=>{y()+T()<R()&&I()}))}},y=()=>p.value?document.documentElement[S.value]||document.body[S.value]:m.value?Math.ceil(m.value[S.value]):0,T=()=>{const e=z.value?"clientWidth":"clientHeight";return p.value?document.documentElement[e]||document.body[e]:m.value?Math.ceil(m.value[e]):0},R=()=>{const e=z.value?"scrollWidth":"scrollHeight";return p.value?document.documentElement[e]||document.body[e]:m.value?Math.ceil(m.value[e]):0},k=e=>{if(p.value)return document.body[S.value]=e,void(document.documentElement[S.value]=e);m.value&&(m.value[S.value]=e)},B=()=>{if(!m.value)return;const e=m.value.getBoundingClientRect(),{defaultView:t}=m.value.ownerDocument;if(t){const a=z.value?e.left+t.pageXOffset:e.top+t.pageYOffset;_.updateParam("slotHeaderSize",a)}},E=()=>{const e=y(),t=T(),i=R();e<0||e+t>i+1||!i||(_.handleScroll(e),((e,t,i)=>{_.isFront()&&s.value.length&&e-u.value<=0?a.emit("totop"):_.isBehind()&&e+t+h.value>=i&&a.emit("tobottom")})(e,t,i))};e.onBeforeUnmount((()=>{_.destroy(),p.value&&document.removeEventListener("scroll",E)}));const N=e.computed((()=>{const{padBehind:e,padFront:t}=f.value;return{padding:z.value?`0px ${e}px 0px ${t}px`:`${t}px 0px ${e}px`}})),b=e.computed((()=>{const{start:e,end:t}=f.value;return void 0===e||void 0===t?s.value:s.value.slice(e,t+1)}));return e.watch(c,(e=>{_.updateParam("keeps",e),_.handleSlotSizeChange()})),e.watch(l,(e=>{x(e)})),e.watch(d,(e=>{k(e)})),e.watch(s,(()=>{_.updateParam("uniqueIds",v.value),_.handleItemsChange()})),{root:m,shepherd:g,onScroll:E,groupStyle:N,isHorizontal:z,range:f,computedItems:b,onItemResized:(e,t)=>{_.saveSize(e,t)},onSlotResized:(e,t)=>{_.updateParam(e,t)},scrollToBottom:I}}});!function(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===a&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}("._rootScrollable_horizontal_1kox7_1 {\n  overflow-x: auto;\n}\n._rootScrollable_vertical_1kox7_4 {\n  overflow-y: auto;\n}\n._root_1kox7_1,\n._group_1kox7_9 {\n  display: flex;\n}\n._root_horizontal_1kox7_12,\n._group_horizontal_1kox7_13 {\n  flex-direction: row;\n}\n._root_vertical_1kox7_16,\n._group_vertical_1kox7_17 {\n  flex-direction: column;\n}");return(r.__cssModules={}).$style={rootScrollable_horizontal:"_rootScrollable_horizontal_1kox7_1",rootScrollable_vertical:"_rootScrollable_vertical_1kox7_4",root:"_root_1kox7_1",group:"_group_1kox7_9",root_horizontal:"_root_horizontal_1kox7_12",group_horizontal:"_group_horizontal_1kox7_13",root_vertical:"_root_vertical_1kox7_16",group_vertical:"_group_vertical_1kox7_17"},r.render=function(t,a,i,o,s,n){const r=e.resolveComponent("item");return e.openBlock(),e.createElementBlock("div",{ref:"root",class:e.normalizeClass([!t.pageMode&&t.$style.rootScrollable,!t.pageMode&&t.$style["rootScrollable_"+t.direction],t.$style.root,t.$style["root_"+t.direction]]),onScroll:a[2]||(a[2]=e=>!t.pageMode&&t.onScroll(e))},[e.createVNode(r,{onItemResize:a[0]||(a[0]=e=>t.onSlotResized("slotHeaderSize",e))},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"before")])),_:3}),e.createElementVNode("div",{role:"group",class:e.normalizeClass([t.$style.group,t.$style["group_"+t.direction]]),style:e.normalizeStyle(t.groupStyle)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.computedItems,(a=>(e.openBlock(),e.createBlock(r,{key:a[t.dataKey],onItemResize:e=>t.onItemResized(a.id,e)},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"default",{item:a})])),_:2},1032,["onItemResize"])))),128))],6),e.createVNode(r,{onItemResize:a[1]||(a[1]=e=>t.onSlotResized("slotFooterSize",e))},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"after")])),_:3}),e.createElementVNode("div",{ref:"shepherd",style:e.normalizeStyle({width:t.isHorizontal?"0px":"100%",height:t.isHorizontal?"100%":"0px"})},null,4)],34)},r}(Vue);
