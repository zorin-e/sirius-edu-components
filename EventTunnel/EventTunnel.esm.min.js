import{defineComponent as e,toRefs as t,ref as u,onMounted as n,onUnmounted as v,watch as a,provide as r,readonly as l,openBlock as o,createElementBlock as s,renderSlot as m}from"vue";import{clamp as d}from"@smartmed/webpatient-vue-components/domain";import{EVENT_TUNNEL_TOKEN as i,EVENT_TUNNEL_PROGRESS_TOKEN as p}from"@smartmed/webpatient-vue-components/tokens";var c=e({props:{duration:{type:Number,required:!0},eventsCount:{type:Number,required:!0},preventOntouch:Boolean},name:"EventTunnel",setup(e){const{duration:o,preventOntouch:s,eventsCount:m}=t(e),c=u([o.value,0]),E=u(0),h=u(null),L=u(null),f=u(null),b=()=>{let e=0;h.value=setInterval((()=>{c.value=[o.value,c.value[1]+1],e=0}),o.value),L.value=setInterval((()=>{e+=1,E.value=d(e/m.value,0,1)}),o.value/m.value)},I=()=>{h.value&&clearInterval(h.value),L.value&&(clearInterval(L.value),E.value=1)},q=()=>I(),w=()=>{I(),b()};return n((()=>{b(),s.value&&f.value&&(f.value.addEventListener("mouseenter",q),f.value.addEventListener("touchstart",q),f.value.addEventListener("touchend",w),f.value.addEventListener("mouseleave",w))})),v((()=>{I(),s.value&&f.value&&(f.value.removeEventListener("mouseenter",q),f.value.removeEventListener("touchstart",q),f.value.removeEventListener("touchend",w),f.value.removeEventListener("mouseleave",w))})),a(o,(e=>{I(),e&&b()})),r(i,l(c)),r(p,l(E)),{host:f}}});const E={ref:"host"};c.render=function(e,t,u,n,v,a){return o(),s("div",E,[m(e.$slots,"default")],512)};export{c as default};
