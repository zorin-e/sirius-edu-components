this.smartmed=this.smartmed||{},this.smartmed.InputPhone=function(e,t,a,n,o){"use strict";function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=l(smartmed.BaseInput);const r=/[ \-_]/g,u="+7 ",d=u.length,i={mask:[...u.split(""),/[1-9]/,/\d/,/\d/," ",/\d/,/\d/,/\d/,"-",/\d/,/\d/,"-",/\d/,/\d/],pipe:e=>""===e?u:e.replace(/[- ]$/,""),guide:!1};var c=e.defineComponent({inheritAttrs:!1,components:{BaseInput:s.default},name:"InputPhone",props:{modelValue:{type:String,required:!0},disabled:Boolean},setup(o,{emit:l}){const{modelValue:s,disabled:c}=e.toRefs(o),p=e.inject(n.SELECTION_CHANGE_TOKEN),m=e.ref(null),f=e.computed((()=>{const e=s.value.replace(/^7/,"")||u,{conformedValue:a}=t.conformToMask(e,i.mask,{guide:!1});return a.replace(/[- ]$/,"")})),v=e.computed((()=>m.value&&m.value.$refs.native.$refs.native)),g=e=>{l("update:modelValue",e)},h=e=>{const t=s.value.length>1&&s.value.length<11,a=e.replace(r,"").length,n=e.replace(/[^0-9]+/g,""),o=String(getSelection()).length;return t&&0===o?`${s.value}${n}`.slice(0,13):a<10?`7${n}`.slice(0,11):`7${n.replace(/^7|^8/,"")}`.slice(0,11)},k=()=>{(()=>{if(!v.value||!m.value)return!1;const{selectionStart:e,selectionEnd:t}=v.value;return m.value.focused&&null!==e&&e<d&&e===t})()&&v.value&&v.value.setSelectionRange(d,d,"none")};return e.watch(s,(e=>{if(e&&11===e.length&&e.startsWith("8")){const t=h(e);g(t)}}),{immediate:!0}),p&&e.watch(p,(()=>{k()})),{baseInput:m,formattedValue:f,onBackspace:e=>{(e.target.selectionStart||0)<=d&&e.target.selectionStart===e.target.selectionEnd&&e.preventDefault()},onPaste:e=>{if(c.value)return;const t=a.getClipboardDataText(e).replace(/^\+?7|8/,""),n=h(t);g(n)},maskOptions:i,updateValue:g}}});return c.render=function(t,a,n,o,l,s){const r=e.resolveComponent("base-input");return e.openBlock(),e.createBlock(r,e.mergeProps(t.$attrs,{autocomplete:"tel","data-automation-id":"smed-input-phone",ref:"baseInput",type:"tel",name:"tel",modelValue:t.formattedValue,"mask-options":t.maskOptions,disabled:t.disabled,onPaste:e.withModifiers(t.onPaste,["prevent"]),"onUpdate:modelValue":t.updateValue,onKeydown:e.withKeys(t.onBackspace,["backspace"])}),null,16,["modelValue","mask-options","disabled","onPaste","onUpdate:modelValue","onKeydown"])},c}(Vue,textMaskCore,smartmed.domain,smartmed.tokens);
