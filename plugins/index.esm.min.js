import{ref as e,readonly as t}from"vue";function n(e){return e.target}function o(e){return"getRootNode"in e&&e.isConnected?e.getRootNode():e.ownerDocument}function u(e){return o(e).activeElement!==e&&!e.disabled}const d={install(d){const i=e(null),r=e=>{u(n(e))&&(i.value=e.relatedTarget)};window.addEventListener("mousedown",(e=>{if(window.removeEventListener("focusout",r),document.activeElement&&document.activeElement!==document.body){let t=null;const o=()=>{i.value=n(e),window.removeEventListener("focusout",o),t&&clearTimeout(t)};window.addEventListener("focusout",o),t=setTimeout((()=>{t=null,window.removeEventListener("focusout",o)}))}else i.value=n(e)})),window.addEventListener("mouseup",(()=>{window.addEventListener("focusout",r)}));let s=null;const a=e=>{i.value=e.target},c=e=>{e.relatedTarget&&!u(e.target)&&(i.value=e.relatedTarget)};window.addEventListener("focusin",(e=>{const t=n(e),u=o(t);if(s&&(s.removeEventListener("focusin",a),s.removeEventListener("focusout",c)),u!==document)s=u,s.addEventListener("focusin",a),s.addEventListener("focusout",c);else{if("-1"===t.getAttribute("tabIndex"))return;i.value=t}})),window.addEventListener("focusout",r),window.addEventListener("blur",(()=>{const e=document.activeElement;e&&e.matches("iframe")&&(i.value=e)})),d.provide("__SmartMed_ACTIVE_ELEMENT_TOKEN",t(i))}},i={install(n){const o=e(null);document.addEventListener("selectionchange",(e=>{o.value=e})),n.provide("__SmartMed_SELECTION_CHANGE_TOKEN",t(o))}};export{d as ActiveElementPlugin,i as SelectionChangePlugin};
